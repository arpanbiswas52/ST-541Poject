---
title: "An  approach to Robust Optimization of Large Scale Complex River System"
author: "Arpan Biswas"
output:
  pdf_document
---
```{r, message=FALSE}
library(here)
```

# Introduction 

Renewable energy, such as hydroenergy, is one of the major sources for electricity generation for energy sectors. Over many decades, there has been continuous development of water resource management for the economic benefit of electricity industries. However, in real world, these energy sectors deal with different sources of uncertainties like Inflows, Market Prices and Market Demand of electricity which significantly impacts their operations and therefore in generating revenue. Therefore, the objective in this project is to generate a Robust Optimization framework for maximizing the Net Revenue and thereby provide a robust solution of optimal operation control. However, RO model is generally too expensive due to it's high simulation and function evaluation costs during quantification and propagation of uncertainity through the large scale complex system. This can make the model inefficient since the operators need to run the model at regular interval of time (hourly). Therfore, in this project, another research objective is to investigate on increasing the efficiency of the model in terms of reducing computational cost and/or providing better optimal solutions.

# Model Description

In this section, we have presented the Robust optimization model and have discussed the efforts done to build the model. Figure 1. provides the high level framework of our model.In this problem, we have selected our decision variables as Outflows from the reservoirs and objective function is maximizing Expected Revenue. The problem consists constraints on Storage, Forebay elevation, Power output and Forebay elevation at end of period. From figure 1, the model starts with inputing Inflows, Price and decision variables as Outflows.After that, a large scale simulations of Storage, Forebay, Tailwater, Head, Energy generation and Revenue is executed and the respective means and standard devaitions is calculated. After that, the model calculates Robust objective function and validates all the Probabilistic constraints. The model then checks if the convergence criteria and no constraints violation have been achieved. If satisfied, the model provides the optimal solution as Outflows and Expected Revenue. If not, the model moves to next iteration and start the simulations again with different sets of decision variables. 

<figure>
  <img src="`r here("results", "Storage_VarianceReduction.png")`" align="left" style="width:50%">
</figure>

# Methodology

In this section, we have discussed about the methodology applied in RO model. Firstly, we have applied Monte Carlo simulations methods to excute the large complex simulations at each iteration of the optimization algorithm. The robust optimzation model has been build in R using package "nloptr" and applying Sequential Quadratic Programing algorithm. This gradient based algorithm is very efficient in any non-linear optimization problems. Though it provides generally a local optimal solution, it quickly converges to a solution. In R, the function needed to call SQP algorithm is "slsqp". However, there is a caveat in "slsqp" as it has restriction to input any arguments other than decision variables to the constraint function provided by the user into the algorithm. We believe this is a bug and in order to complete the project, we had to rewrite all the inputs and initial conditions again inside the constraint function. Due to this limitations, the coding might look repeatative in the constraint function. In this project, the convergence criteria is the step size of decision variables $< 1e-10$. Since one of our prime focus is the computational efficieny of the model, we have always attempted to code the RO model efficiently by extensive applications of operations of large data in vectors and matrices, using `rowMeans()`, `colMeans()` etc., avoiding loops in large simulations. However, we had to use loops in calculating some quantities like Storage in each days (timesteps) since we need to know the value of storage at pervious day to calculate the storage at the current day. Therefore calculating the value of storage of 14 days together was not possible using operations in vectors. However, this will not significantly increase the runtime as we need to calculate for 14 days only (14 iterations). 

# Analysis

In this section, we have mentioned about the analysis done on the RO model to increase the efficieny of the model. As we mentioned, MC approach has been taken initially to perform the simulations. However, MC approach is computationally inefficient. This could increase the computational cost of the model significantly and therefore we have attmepted Antithetic Variable approach. Antithetic variable apporach can reduce the variance and provide better estimations and also required less sampling which can increase the overall computational efficieny of the model. Therfore, we have compared the performance of RO model using MC apporach and Antithetic variable approach. We also went further to compare with Important Sampling approach. However, it turned out to be too complex to code in our problem and due to the time constraint to complete the project we have decided to consider this as a future task.

# Results

In this section, we have provided the description of the case study and all the results from the model and model comparsions. 

